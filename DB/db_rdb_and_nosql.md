# RDB와 NoSQL

## RDB

* `RDB` 란 관계형 데이터 모델에 기초를 둔 데이터베이스이다. 관계형 데이터 모델이란 데이터를 구성하는데 필요한 방법 중 하나로 모든 데이터를 **2차원의 테이블 형태로 표현**해준다.

* 관계형 데이터 모델의 개념은 데이터 간의 상관관계에서 개체간의 관계를 표현한 것이라고 할 수 있다.

* 관계형 데이터베이스 모델의 주요 이점은 직관적인 데이터 표현 방법을 제공하고 관련 데이터 포인트에 쉽게 접근할 수 있다는 점이다. 그래서 관계형 데이터 베이스는 인벤토리 추적부터 트랜잭션 데이터 처리 및 애플리케이션 로깅에 이르기까지 **대량의 구조화된 데이터를 관리해야 하는 조직에서 가장 많이 사용**한다.

* 관계형 데이터베이스를 사용하면 데이터를 관리하고 저장할 때 다음과 같은 **여러 가지 장점**이 있다.

* `RDB`의 이점

  * [1] 유연성(CRUD) : 전체 데이터베이스 구조를 변경하거나 기존 애플리케이션에 영향을 주지 않고 **필요할 때마다 간편하게 테이블, 관계를 `추가` 또는 `삭제`하고 데이터를 `변경`**할 수 있다.

  * [2] 사용 편의성 : 기술자가 아닌 사용자도 데이터베이스와 상호작용하는 방법을 배울 수 있는 **`SQL`을 사용하여 복잡한 쿼리를 쉽게 실행**할 수 있다.

  * [3] 내장된 보안 기능 : 역할 기반 보안을 통해 **데이터 액세스가 특정 사용자로 제한**된다.

  * [4] ACID 규정 준수 : 관계형 데이터베이스는 **`ACID`(원자성, 일관성, 격리, 내구성) 성능을 지원**하므로 오류, 실패, 기타 잠재적 오작동에 관계없이 **데이터 유효성을 검사**할 수 있다.

  * [5] 공동작업 : 여러 사용자가 동시에 데이터를 운영하고 액세스할 수 있다. 기본 제공되는 잠금 기능으로 **업데이트 도중 데이터에 동시 액세스할 수 없다**.

  * [6] 데이터베이스 정규화 : 관계형 데이터베이스는 **데이터 중복성을 줄이고 데이터 무결성을 개선하는 `정규화`라는 설계 기법을 사용**한다.

## RDBMS

* `관계형 데이터베이스 관리 시스템(RDBMS)`는 행과 열을 가지는 표 형식 데이터를 저장하는 형태의 데이터베이스를 가리키며 SQL 이라는 언어를 써서 조작한다.

* 관계형 데이터베이스를 관리하기 위한 소프트웨어이다.

* 모든 데이터를 **2차원 데이블**로 표현하고, 테이블은 **행(Record, Tuple)과 열(Filed, Item)** 로 이루어진 기본 데이터 저장 단위이다.

* **테이블 간 `관계`를 가질 수 있다는 것**이 가장 큰 특징이다.

* 관계형 데이터베이스를 다루기 위한 언어를 `SQL` 이라고 한다.

![](/DB/img/db-rdb-nosql-1.png)

* RDBMS 종류에는 `MySQL`, `PostgreSQL`, `Oracle`, `Microsoft SQL Server`, `MariaDB` 등이 있다.

* 현재 기준(2023.02.13) 가장 인기있는 10가지 DB는 다음과 같다.(DBMS, NoSQL 모두 포함)

![](/DB/img/db-rdb-nosql-2.png)

* 관계형 데이터베이스의 경우 표준 SQL은 지키기는 하지만, 각각의 제품에 특화시킨 `SQL`을 사용한다.

  * 예를 들어 Oracle의 경우 PL/SQL 이라고 하며 SQL Server에서는 T-SQL, MySQL은 SQL을 사용한다.


### MySQL

* `MySQL` 은 대부분의 OS(운영체제)와 호환되며 현재 2위로 많이 사용하는 데이터베이스 관리 시스템이며 메타, 트위터 등 많은 기업에서 MySQL를 사용하고 있다.

  * 참고) - [DB-Engines Ranking](https://db-engines.com/en/ranking)

* C, C++로 만들어졌으며 MyISAM 인덱스 압축 기술, B-tree 기반의 인덱스, Thread 기반의 메모리 할당 시스템, 매우 빠른 조인, 최대 64개의 인덱스를 제공한다.

* **대용량 데이터베이스**를 위해 설계되어 있고 롤백, 커밋, 이중 암호 지원 보안등의 기능을 제공하며 많은 서비스에서 사용한다.

* MySQL의 스토리지 엔진 아키텍쳐는 다음과 같다.

![](/DB/img/db-rdb-nosql-3.png)

* 데이터베이스의 심장과도 같은 역할을 하는 곳이 바로 `스토리지 엔진`인데, **모듈식 아키텍쳐**로 쉽게 스토리지 엔진을 바꿀 수 있으며, 데이터 웨어하우징, 트랜잭션 처리, 고가용성 처리에 강점을 두고 있다.

* 스토리지 엔진 위에는 `커넥터 API` 및 `서비스 계층`을 통해 MySQL 데이터베이스와 쉽게 상호 작용할 수 있다.

* 또한, MySQL은 **쿼리 캐시를 지원**해서 입력된 쿼리 문에 대한 전체 결과 집합을 저장하기 때문에 사용자가 작성한 쿼리가 캐시에 있는 쿼리와 동일하면 서버는 단순히 구문 분석, 최적화 및 실행을 건너뛰고 캐시의 출력만 표시한다.

* 하지만 MySQL에는 단점들이 있다.

  * 복잡한 쿼리를 사용할 때에는 성능 저하를 일으킨다.

  * 트랜잭션 지원이 완벽하지 않다.

  * 사용자정의 함수의 사용이 쉽지 않고 유연하지 않는다.

### PostgreSQL

* `PostgreSQL` 역시 개발자들이 선호하는 데이터베이스 기술로 널리 인정받고 있다.(세계 4위)

![](/DB/img/db-rdb-nosql-4.png)

* PostgreSQL 은 수년간 압도적인 성장 속도를 보여주며 3위와의 격차를 좁혀나가고 있다.

* 다른 제품과 비교하면 부족하지 않는 기능과 성능을 갖추고 있고, 새로운 개발자들이 입문하기 좋은 조건들을 가지고 있기 때문이다.

* 실제 PostgreSQL 사용자가 꼽은 대표적인 특징은 다음과 같다. (Why PostgreSQL ?)

  * 최다 SQL 기능 지원 : 가장 오랜 기간 개발을 거친 PostgreSQL은 **관계형 데이터베이스 중에서 최다 SQL을 지원**한다.

  * 최다 SQL 표준 지원 : PostgreSQL은 전체 179 항목 중 170 항목인 약 95%의 SQL 표준을 지원한다.

  * 풍부한 데이터 유형 지원 : PostgreSQL이 지원하는 데이터 유형은 일부 NoSQL도 포함하고 있다. 이능 차별화된 확장 기능으로 제공된다.

    * Key-Value, XML, JSON, JSONB, Columnar Store, Graph

  * 프로그래밍 언어 지원 : Server-side language, C/C++, PL/pgSQL, PL/Tcl, PL/Perl, PL/Python, PL/Ruby, PL/Java, PL/Lua, PL/R, PL/sh, PL/v8

  * 대량 데이터 처리 : 다음과 같은 기능 덕분에 대량 데이터 처리가 가능하다.

    * Table Partitioning

    * Parallel query & Multiple processes

    * Analytic & Aggregate functions

    * Indexing & Join

### Oracle

* 미국의 오라클 회사에서 제작한 **세계 점유율 1위** 데이터베이스 관리 시스템이며 현재 **유닉스 체제에서 가장 많이 사용**되는 DBMS이다.

* 오라클의 장점은 다음과 같다.

  * 관리 시스템 : 멀티플 데이터베이스 튜닝이 가능하고 다수의 사용자가 동시에 접근이 가능하다.

  * 변화 관리 : 변경 plan을 작성하고 실제 구현하기 전에 변경 사항의 효과를 볼 수 있다. 또한 생산 시스템을 방해하지 않는다.

  * 경고 : 오류가 발생하면 설정되어 있는 계정 및 이메일로 연락이 온다. 경고는 예정된 가종 정지 시간 동안 차단될 수 있다.

  * 분산 처리: DBMS 실행 컴퓨터, 서버 역할 컴퓨터, DB 응용 프로그램 실행 컴퓨터 각각 다르게 분산처리가 가능하다.

  * 용량과 처리 : 다른 데이터베이스보다 **고성능의 트랜잭션을 처리**한다. 그리고 비용을 최소화하기 위해 테이블과 인덱스를 분석한다.

* 오라클의 단점은 다음과 같다.

  * 비용적인 부담이 있다.

  * 기능이 많기 때문에 초보자가 사용하기 어려움이 있다.

  * 높은 지원의 하드웨어 사양이 필요하다.

* 대체적으로 돈이 적거나 중소기업들은 MySQL을 선호하고, 충분한 예산과 복잡한 비즈니스 구를 수행하는 큰 프로젝트를 주로 수행하는 대기업은 Oracle을 선호한다.


## NoSQL

* NoSQL(Not only SQL)이라는 슬로건에서 생겨난 데이터베이스이다. SQL을 사용하지 않는 데이터베이스를 말하며, 대표적으로 `MongoDB`, `Redis` 등이 있다.

* RDBMS 방식으로 더이상 처리할 수 없을 만큼의 **복잡하고 큰 데이터들이 등장**하거나, SNS 같은 **처리 속도를 극한으로 끌어올려야 하는 서비스들이 등장**하면서 NoSQL이 부각되기 시작했다.

* 관계형 데이터베이스가 아니기 때문에, 정해진 스키마가 없어 **자유롭게 데이터를 저장할 수 있고 중복 데이터도 허용**한다.

* 정확도를 포기하고 자유도를 높여 입출력의 속도를 강화하여 ACID 역시 엄격하게 지켜지지 않는다.

### MongoDB

![](/DB/img/db-rdb-nosql-mongodb.png)

* `MongoDB`는 JSON을 통해 데이터에 접근할 수 있고, Binary JSON 형태(BSON)로 데이터가 저장되며 와이어드타이거 엔진이 기본 스토리지 엔진으로 장착된 **키-값 데이터 모델에서 확장된 도규먼트 기반의 데이터베이스**이다.

* 확장성이 뛰어나며 빅데이터를 저장할 때 성능이 좋고 고가용성과 샤딩, 레플리카셋을 지원한다.

* 또한 스키마를 정해 놓지 않고 데이터를 삽입할 수 있기 때문에 다양한 도메인의 데이터베이스를 기반으로 분석하거나 로깅 등을 구현할 때 강점을 보인다.

* 그리고 MongoDB는 도규먼트를 생성할 때마다 다른 컬렉션에서 중복된 값을 지니기 힘든 유니크한 값인 `ObjectID`가 생성된다.

  * 이는 기본키로 유닉스 시간 기반의 타임스탬프(4바이트), 랜덤 값(5바이트), 카운터(3바이트)로 이루어져 있다.

### Redis

![](/DB/img/db-rdb-nosql-redis.png)

* `Redis`는 인메모리 데이터베이스자 키-값 데이터 모델 기반의 데이터베이스이다.

* 기본적인 데이터 타입은 문자열(string)이며 최대 512MB까지 저장할 수 있다. 이외에도 Set, Hash 등을 지원한다.

* Pub/Sub 기능을 통해 채팅 시스템, 다른 데이터베이스 앞단에 두어 사용하는 캐싱 계층, 단순한 키-값이 필요한 세션 정보 관리, 정렬된 Set 자료 구조를 이용한 실시간 순위표 서비스에 사용한다.


## RDBMS vs NoSQL

* `RDBMS` 는 **데이터 구조가 명확하고 변경될 여지가 없으며 **명확한 스키마**가 중요한 경우, 또한 중복된 데이터가 없어(**데이터 무결성**) 변경이 용이하기 때문에 관계를 맺고 데이터가 자주 변경이 이루어지는 시스템에 적합하다.

* `NoSQL` 은 **정확한 데이터 구조를 알 수 없고 데이터가 변경 또는 확장**이 될 수 있는 경우에 사용하는 것이 좋다. 하지만 데이터 중복이 발생할 수 있으며 중복된 데이터가 변경될 시에는 모든 컬렉션에서 수정을 해야하기 때문에, **Update가 많이 이루어지지 않는** 시스템이 좋다.

  또한 확장이 가능하다는 장점을 활용해 **막대한 데이터를 저장해야 하는 시스템**에 적합하다.

<table>
  <tr>
    <th></th>
    <th>RDBMS</th>
    <th>NoSQL</th>
  </tr>
  <tr>
    <td rowspan="5">장점</td>
    <td>Data를 Column과 Row형태로 저장한다.</td>
    <td>데이터간의 관계를 정의하지 않는다.(join 불필요하고 불가능하다)</td>
  </tr>
  <tr>
    <td>데이터의 분류,정렬, 탐색 속도가 빠르다.</td>
    <td>RDBMS보다 복잡도가 떨어져 훨씬 대용량의 데이터를 관리하고 저장한다.</td>
  </tr>
  <tr>
    <td>SQL이라는 구조화된 방식으로 데이터를 다룬다.</td>
    <td>스키마가 정해져있지 않아 자유로운 데이터 저장이 가능하다</td>
  </tr>
  <tr>
    <td>작업의 완전성을 보장한다.</td>
    <td>많은 양의 데이터를 저장하고 처리한다.</td>
  </tr>
  <tr>
    <td>데이터의 UPDATE가 빠르다.</td>
    <td></td>
  </tr>
  <tr>
    <td rowspan="3">단점</td>
    <td>반드시 스키마 규격에 맞춰서 데이터를 다뤄야 한다.</td>
    <td>스키마가 정해져 있지 않아, 데이터가 규격화 되어있지 않다.</td>
  </tr>
  <tr>
    <td>데이터 처리에 대한 부하 발생시 처리에 어려움이 있다.</td>
    <td>Key값에 대한 입.출력만 지원한다.</td>
  </tr>
  <tr>
    <td>성능향상에 (Scale-up) 높은 비용이 발생한다.</td>
    <td>UPDATE 하는데 비교적 느리다.</td>
  </tr>
</table>



## Reference

* [면접을 위한 CS 전공지식 노트](https://product.kyobobook.co.kr/detail/S000001834833)

* [관계형 데이터베이스란 무엇인가요?](https://cloud.google.com/learn/what-is-a-relational-database?hl=ko)

* [기업 데이터 환경에 PostgreSQL이 최적인 이유](https://bitnine.tistory.com/516)

* [PostgreSQL을 선택한 이유](https://codecamp.tistory.com/2)

* [Oracle과 MySQL의 차이점](https://velog.io/@alicesykim95/Oracle%EA%B3%BC-MySQL%EC%9D%98-%EC%B0%A8%EC%9D%B4%EC%A0%90)

* [Database - RDBMS 와 NoSQL](https://eshley9199.tistory.com/123)